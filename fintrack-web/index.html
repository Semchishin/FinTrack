<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FinTrack - Finance Management</title>

  <!-- CSS Stylesheets -->
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Favicon -->
  <link rel="icon" href="icon.png">

  <!-- Meta tags for better SEO and social sharing -->
  <meta name="description" content="FinTrack - Simple finance management application">
  <meta name="keywords" content="finance, budget, transactions, money management">
  <meta name="author" content="FinTrack Team">
</head>
<body>
<!-- Main Container -->
<div class="container">

  <!-- Header Section -->
  <header class="header">
    <div class="logo">
      <img src="icon.svg" alt="FinTrack Logo" height="40">
      <h1>FinTrack</h1>
    </div>
    <button class="btn btn-primary" onclick="openCreateModal()">
      <i class="fas fa-plus"></i> New Transaction
    </button>
  </header>

  <!-- Notification Area (for success/error messages) -->
  <div id="notification" class="notification hidden"></div>

  <!-- Filters Section -->
  <section class="filters">
    <div class="search-box">
      <i class="fas fa-search"></i>
      <input type="text" id="searchInput" placeholder="Search transactions..."
             oninput="filterTransactions()" aria-label="Search transactions">
    </div>

    <div class="filter-controls">
      <!-- Category Filter Dropdown -->
      <select id="categoryFilter" onchange="filterTransactions()" aria-label="Filter by category">
        <option value="">All categories</option>
        <!-- Categories will be populated dynamically -->
      </select>

      <!-- Date Range Filters -->
      <div class="date-filters">
        <input type="date" id="dateFrom" onchange="filterTransactions()"
               title="Filter from date" aria-label="Filter from date">
        <span>to</span>
        <input type="date" id="dateTo" onchange="filterTransactions()"
               title="Filter to date" aria-label="Filter to date">
      </div>

      <!-- Amount Range Filters -->
      <input type="number" id="minAmount" placeholder="Min amount"
             oninput="filterTransactions()" title="Minimum amount"
             aria-label="Minimum amount" step="0.01" min="0">
      <input type="number" id="maxAmount" placeholder="Max amount"
             oninput="filterTransactions()" title="Maximum amount"
             aria-label="Maximum amount" step="0.01" min="0">
    </div>
  </section>

  <!-- Statistics Section -->
  <section class="stats-grid" aria-label="Transaction statistics">
    <!-- Total Amount Card -->
    <div class="stat-card" role="region" aria-label="Total amount statistics">
      <div class="stat-icon total">
        <i class="fas fa-money-bill-wave" aria-hidden="true"></i>
      </div>
      <div class="stat-info">
        <h3>Total Amount</h3>
        <p id="totalAmount" class="amount">0 ₽</p>
      </div>
    </div>

    <!-- Transaction Count Card -->
    <div class="stat-card" role="region" aria-label="Transaction count statistics">
      <div class="stat-icon count">
        <i class="fas fa-list" aria-hidden="true"></i>
      </div>
      <div class="stat-info">
        <h3>Transactions</h3>
        <p id="totalCount">0</p>
      </div>
    </div>

    <!-- Average Amount Card -->
    <div class="stat-card" role="region" aria-label="Average amount statistics">
      <div class="stat-icon avg">
        <i class="fas fa-calculator" aria-hidden="true"></i>
      </div>
      <div class="stat-info">
        <h3>Average</h3>
        <p id="averageAmount">0 ₽</p>
      </div>
    </div>

    <!-- Last Added Card -->
    <div class="stat-card" role="region" aria-label="Last transaction statistics">
      <div class="stat-icon recent">
        <i class="fas fa-clock" aria-hidden="true"></i>
      </div>
      <div class="stat-info">
        <h3>Last Added</h3>
        <p id="lastAdded">-</p>
      </div>
    </div>
  </section>

  <!-- Transactions Table Section -->
  <section class="table-wrapper" aria-label="Transactions list">
    <table role="grid" aria-label="Transactions table">
      <thead>
      <tr>
        <th scope="col" role="columnheader">Amount</th>
        <th scope="col" role="columnheader">Category</th>
        <th scope="col" role="columnheader">Created At</th>
        <th scope="col" role="columnheader">Actions</th>
      </tr>
      </thead>
      <tbody id="transactionsTable">
      <!-- Transaction rows will be inserted here by JavaScript -->
      </tbody>
    </table>

    <!-- Loading Indicator -->
    <div id="loading" class="loading" role="status" aria-live="polite">
      <i class="fas fa-spinner fa-spin" aria-hidden="true"></i>
      <span>Loading transactions...</span>
    </div>

    <!-- No Data State -->
    <div id="noData" class="no-data hidden" role="status" aria-live="polite">
      <i class="fas fa-database" aria-hidden="true"></i>
      <p>No data to display</p>
      <button class="btn btn-primary" onclick="openCreateModal()">
        <i class="fas fa-plus"></i> Create First Transaction
      </button>
    </div>
  </section>
</div>

<!-- Create/Edit Transaction Modal -->
<div id="modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
  <div class="modal-content">
    <div class="modal-header">
      <h2 id="modalTitle">New Transaction</h2>
      <button class="close-btn" onclick="closeModal()" aria-label="Close modal">&times;</button>
    </div>

    <form id="transactionForm" onsubmit="handleSubmit(event)" role="form" aria-labelledby="modalTitle">
      <!-- Hidden field for transaction ID (used in edit mode) -->
      <input type="hidden" id="transactionId">

      <!-- Amount Input Field -->
      <div class="form-group">
        <label for="amount">
          <i class="fas fa-ruble-sign" aria-hidden="true"></i>
          Amount <span class="required" aria-hidden="true">*</span>
        </label>
        <input type="number" id="amount" step="0.01" min="0.01" required
               placeholder="0.00" title="Transaction amount"
               aria-required="true" aria-describedby="amountHelp">
        <small id="amountHelp" class="form-help">Enter the transaction amount</small>
      </div>

      <!-- Category Input Field with Autocomplete -->
      <div class="form-group">
        <label for="category">
          <i class="fas fa-tag" aria-hidden="true"></i>
          Category
        </label>
        <input type="text" id="category" list="categories"
               placeholder="Enter category" title="Transaction category"
               aria-describedby="categoryHelp">
        <datalist id="categories">
          <!-- Categories will be populated dynamically -->
        </datalist>
        <small id="categoryHelp" class="form-help">Type to see existing categories</small>
      </div>

      <!-- Form Action Buttons -->
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" onclick="closeModal()">
          Cancel
        </button>
        <button type="submit" class="btn btn-primary">
          <i class="fas fa-save" aria-hidden="true"></i> Save
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="deleteModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="deleteModalTitle">
  <div class="modal-content">
    <div class="modal-header">
      <h2 id="deleteModalTitle">Confirm Delete</h2>
      <button class="close-btn" onclick="closeDeleteModal()" aria-label="Close modal">&times;</button>
    </div>

    <div class="modal-body">
      <p>Are you sure you want to delete this transaction?</p>
      <p><strong>Amount:</strong> <span id="deleteAmount"></span></p>
      <p><strong>Category:</strong> <span id="deleteCategory"></span></p>
    </div>

    <div class="form-actions">
      <button type="button" class="btn btn-secondary" onclick="closeDeleteModal()">
        Cancel
      </button>
      <button type="button" class="btn btn-danger" onclick="confirmDelete()">
        <i class="fas fa-trash" aria-hidden="true"></i> Delete
      </button>
    </div>
  </div>
</div>

<!-- JavaScript Files (loaded at the end for better performance) -->
<script src="js/app.js"></script>

<!-- Inline script for initial setup -->
<script>
  // Set current date as default in date filters
  document.addEventListener('DOMContentLoaded', function() {
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('dateTo').value = today;

    // Set dateFrom to 30 days ago by default
    const thirtyDaysAgo = new Date();
    thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
    document.getElementById('dateFrom').value = thirtyDaysAgo.toISOString().split('T')[0];
  });
</script>
</body>
</html>
